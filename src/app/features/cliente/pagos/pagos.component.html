<div class="page-container">
  <!-- Header -->
  <div class="page-header">
    <h1>üí≥ Pagos</h1>
    <button class="btn btn-primary" (click)="abrirModalNuevo()">
      ‚ûï Nuevo Pago
    </button>
  </div>

  <!-- Error Alert -->
  <div *ngIf="error" class="alert alert-error">
    {{ error }}
    <button class="alert-close" (click)="error = null">‚úï</button>
  </div>

  <!-- Loading -->
  <div *ngIf="loading && pagos.length === 0" class="loading">
    Cargando pagos...
  </div>

  <!-- Tabla -->
  <div *ngIf="!loading || pagos.length > 0" class="table-container">
    <table class="table">
      <thead>
        <tr>
          <th>ID</th>
          <th>Reserva</th>
          <th>Cliente</th>
          <th>Monto</th>
          <th>M√©todo</th>
          <th>Estado</th>
          <th>Fecha</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let pago of pagos">
          <td>{{ pago.idPago }}</td>
          <td>{{ pago.idReserva }}</td>
          <td>{{ pago.idCliente }}</td>
          <td>${{ pago.monto | number: '1.2-2' }}</td>
          <td>
            <span class="badge badge-method">{{ pago.metodo }}</span>
          </td>
          <td>
            <span class="badge" [ngClass]="getEstadoBadgeClass(pago.estadoPago)">
              {{ pago.estadoPago }}
            </span>
          </td>
          <td>{{ pago.fechaPago | date: 'short' }}</td>
          <td>
            <div class="actions">
              <button class="btn-icon btn-edit" (click)="abrirModalEditar(pago)" title="Editar">
                ‚úèÔ∏è
              </button>
              <button class="btn-icon btn-delete" (click)="eliminar(pago.idPago)" title="Eliminar">
                üóëÔ∏è
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>

    <div *ngIf="pagos.length === 0" class="empty-state">
      No hay pagos registrados
    </div>
  </div>
</div>

<!-- Modal -->
<div *ngIf="showModal" class="modal-overlay" (click)="cerrarModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>{{ isEditMode ? 'Editar Pago' : 'Nuevo Pago' }}</h2>
      <button class="modal-close" (click)="cerrarModal()">‚úï</button>
    </div>

    <form class="modal-body" (ngSubmit)="guardar()">
      <div class="form-group">
        <label>ID Reserva *</label>
        <input type="number" [(ngModel)]="form.idReserva" name="idReserva" required>
      </div>

      <div class="form-group">
        <label>ID Cliente *</label>
        <input type="number" [(ngModel)]="form.idCliente" name="idCliente" required>
      </div>

      <div class="form-group">
        <label>Monto *</label>
        <input type="number" [(ngModel)]="form.monto" name="monto" required min="0" step="0.01">
      </div>

      <div class="form-group">
        <label>M√©todo de Pago *</label>
        <select [(ngModel)]="form.metodo" name="metodo" required>
          <option *ngFor="let metodo of metodos" [value]="metodo">{{ metodo }}</option>
        </select>
      </div>

      <div class="form-group">
        <label>Estado del Pago *</label>
        <select [(ngModel)]="form.estadoPago" name="estadoPago" required>
          <option *ngFor="let estado of estados" [value]="estado">{{ estado }}</option>
        </select>
      </div>

      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" (click)="cerrarModal()">
          Cancelar
        </button>
        <button type="submit" class="btn btn-primary" [disabled]="loading">
          {{ loading ? 'Guardando...' : 'Guardar' }}
        </button>
      </div>
    </form>
  </div>
</div>